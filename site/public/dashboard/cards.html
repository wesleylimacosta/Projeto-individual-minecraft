<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/minecraft-icone-icon.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mineland | Quiz</title>

    <link rel="stylesheet" href="../css/dashboards.css">
    <link rel="stylesheet" href="../css/Quiz.css">

    <script src="../js/funcoes.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
</head>

<body onchange="media()">

    <div class="janela">


        <div class="header-left dash-header">

            <h1>MINELAND</h1>

            <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div>

            <div class="btn-nav">
                <h3>QUIZ</h3>
            </div>

            <div class="btn-nav-white">
                <a href="./dashboard.html">
                    <h3>Mini-game</h3>
                </a>
            </div>

            <div class="btn-nav-white">
                <a href="./mural.html">
                    <h3>Feedback</h3>
                </a>
            </div>

            <div class="btn-logout" onclick="limparSessao()">       
                <h3>Sair</h3>
            </div>

        </div>

        <div class="dash">
            <div class="banner">
                <div class="container">
                    <div class="quiz" id="quiz" style="display:block">
                        <div class="imagem"></div>
                        <button onclick="iniciar()">Iniciar quiz</button>
                    </div>
                    <div class="pt1" id="pt1" style="display:none">
                        <div class="imagempt1">
                            <p>Qual o mob mais forte do minecraft?</p>
                            <input type="text" id="in_mob" class="in_input"><button onclick="perguntaUM()"
                                class="in_btn">Enviar</button><br>
                            <p class="in_lista">Enderman<br>
                                EnderDragon<br>
                                Zombie<br>
                                Warden</p>
                        </div>
                    </div>
                    <div class="pt2" id="pt2" style="display:none;">
                        <p>Qual picareta tem a melhor qualidade?</p>
                        <input type="text" id="in_picareta" class="in_input2">
                        <button onclick="perguntaDOIS()" class="in_btn2">Enviar</button><br>
                        <p class="in_lista" style="font-size:0.8em;position:relative;bottom:3em">Picareta de madeira<br>
                            Picareta de ferro<br>
                            Picareta de ouro<br>
                            Picareta de diamante<br>
                            Picareta de netherite</p>
                    </div>
                    <div class="pt3" id="pt3" style="display:none;">
                        <p>Qual a comida mais forte? </p>
                        <input type="text" id="in_fruta" class="in_input3">
                        <button onclick="perguntaTRES()" class="in_btn3">Enviar</button><br>
                        <p class="in_lista">Cenoura dourada<br>
                            Fruta do coro<br>
                            Maca encantada<br>
                            Cenoura<br>
                            Melancia</p>
                    </div>
                    <div class="pt4" id="pt4" style="display:none;">
                        <p> Qual a espada mais forte?</p>
                        <input type="text" id="in_espada" class="in_input4">
                        <button onclick="perguntaQUATRO()" class="in_btn4">Enviar</button><br>
                        <p class="in_lista">Espada de madeira<br>
                            Espada de ferro<br>
                            Espada de ouro<br>
                            Espada de diamante<br>
                            Espada de netherite</p>
                    </div>
                    <div class="pt5" id="pt5" style="display:none;">
                        <p> Qual destes youtubers, tem um melhor conhecimento em sistemas de redstone?</p>
                        <input type="text" id="in_youtuber" class="in_input5">
                        <button onclick="perguntaCINCO()" class="in_btn5">Enviar</button><br>
                        <p class="in_lista">Vinicius13<br>
                            RezendeEvil<br>     
                            AuthentichGames<br>
                            TazerCraft<br>
                            Am3nic<br>
                        </p>
                    </div>
                    <div class="fim" id="fim" style="display:none ;">
                        <h3>Parabens você chegou ao fim do quiz!</h3>
                        <span>Você conquistou: <span id="b_pontos">0</span>pontos</span><br>
                        <span>Media de acerto dos usuarios: <span id="b_media">0</span></span>
                        <button onclick="RespostasQUIZ()">Enviar respostas</button>
                    </div>

                </div>

            </div>
        </div>
    </div>



    </div>
    </div>


</body>

<script>
    b_media.innerHTML = sessionStorage.MEDIA_USUARIOS

    b_usuario.innerHTML = sessionStorage.NOME_USUARIO
    var parte1Var = ''
    var parte2Var = ''
    var parte3Var = ''
    var parte4Var = ''
    var parte5Var = ''
    var pontos = 0
    var ID_USUARIOVar = sessionStorage.ID_USUARIO

    function iniciar() {
        quiz.style.display = 'none'
        pt1.style.display = 'block'
    }

    function perguntaUM() {
        var resposta1 = in_mob.value.toLowerCase()

        if (resposta1 == 'enderman') {
            pt1.style.display = 'none'
            pt2.style.display = 'block'
            parte1Var = 'enderman'
        } else if (resposta1 == 'enderdragon') {
            pt1.style.display = 'none'
            pt2.style.display = 'block'
            parte1Var = 'enderdragon'

        } else if (resposta1 == 'zombie') {
            pt1.style.display = 'none'
            pt2.style.display = 'block'
            parte1Var = 'zombie'
        } else if (resposta1 == 'warden') {
            pt1.style.display = 'none'
            pt2.style.display = 'block'
            parte1Var = 'warden'
            pontos++
        } else if (resposta1 == '') {
            alert('Preencha o campo e tente novamente')
        } else {
            alert('Você deve escrever somente entre os mobs da lista')
        }
    }

    function perguntaDOIS() {
        var resposta2 = in_picareta.value.toLowerCase()

        if (resposta2 == 'picareta de madeira') {
            pt2.style.display = 'none'
            pt3.style.display = 'block'
            parte2Var = 'picareta de madeira'
        } else if (resposta2 == 'picareta de ferro') {
            pt2.style.display = 'none'
            pt3.style.display = 'block'
            parte2Var = 'picareta de ferro'
        } else if (resposta2 == 'picareta de ouro') {
            pt2.style.display = 'none'
            pt3.style.display = 'block'
            parte2Var = 'picareta de ouro'
        } else if (resposta2 == 'picareta de diamante') {
            pt2.style.display = 'none'
            pt3.style.display = 'block'
            parte2Var = 'picareta de diamante'
        } else if (resposta2 == 'picareta de netherite') {
            pt2.style.display = 'none'
            pt3.style.display = 'block'
            parte2Var = 'picareta de netherite'
            pontos++
        } else if (resposta2 == '') {
            alert('Preencha o campo e tente novamente')
        } else {
            alert('Você deve escrever somente entre as picaretas da lista')
        }
    }
    function perguntaTRES() {
        var resposta3 = in_fruta.value.toLowerCase()

        if (resposta3 == 'maca encantada') {
            pt3.style.display = 'none'
            pt4.style.display = 'block'
            parte3Var = 'maca encantada'
            pontos++
        } else if (resposta3 == 'fruta do coro') {
            pt3.style.display = 'none'
            pt4.style.display = 'block'
            parte3Var = 'fruta do coro'
        } else if (resposta3 == 'cenoura') {
            pt3.style.display = 'none'
            pt4.style.display = 'block'
            parte3Var = 'cenoura'
        } else if (resposta3 == 'cenoura dourada') {
            pt3.style.display = 'none'
            pt4.style.display = 'block'
            parte3Var = 'cenoura dourada'
        } else if (resposta3 == 'melãncia') {
            pt3.style.display = 'none'
            pt4.style.display = 'block'
            parte3Var = 'melãncia'
        } else if (resposta3 == '') {
            alert('Preencha o campo e tente novamente')
        }
        else {
            alert('Você deve escrever somente entre as comidas da lista')
        }
    }
    function perguntaQUATRO() {
        var resposta4 = in_espada.value.toLowerCase()

        if (resposta4 == 'espada de madeira') {
            pt4.style.display = 'none'
            pt5.style.display = 'block'
            parte4Var = 'espada de madeira'
        } else if (resposta4 == 'espada de ferro') {
            pt4.style.display = 'none'
            pt5.style.display = 'block'
            parte4Var = 'espada de ferro'
        } else if (resposta4 == 'espada de ouro') {
            pt4.style.display = 'none'
            pt5.style.display = 'block'
            parte4Var = 'espada de ouro'
        } else if (resposta4 == 'espada de diamante') {
            pt4.style.display = 'none'
            pt5.style.display = 'block'
            parte4Var = 'espada de diamante'
        } else if (resposta4 == 'espada de netherite') {
            pt4.style.display = 'none'
            pt5.style.display = 'block'
            parte4Var = 'espada de netherite'
            pontos++
        } else if (resposta4 == '') {
            alert('Preencha o campo e tente novamente')
        }
        else {
            alert('Você deve escrever somente entre as comidas da lista')
        }
    }
    function perguntaCINCO() {
        var resposta5 = in_youtuber.value.toLowerCase()

        if (resposta5 == 'vinicius13') {
            pt5.style.display = 'none'
            fim.style.display = 'block'
            parte5Var = 'vinicius13'
            pontos++

        } else if (resposta5 == 'rezendeevil') {
            pt5.style.display = 'none'
            fim.style.display = 'block'
            parte5Var = 'rezendeevil'
        } else if (resposta5 == 'authenticgames') {
            pt5.style.display = 'none'
            fim.style.display = 'block'
            parte5Var = 'authenticgames'
        } else if (resposta5 == 'tazercraft') {
            pt5.style.display = 'none'
            fim.style.display = 'block'
            parte5Var = 'tazercraft'
        } else if (resposta5 == 'am3nic') {
            pt5.style.display = 'none'
            fim.style.display = 'block'
            parte5Var = 'am3nic'
        } else if (resposta5 == '') {
            alert('Preencha o campo e tente novamente')
        }
        else {
            alert('Você deve escrever somente entre os youtubers da lista')
        }
        b_pontos.innerHTML = pontos
    }

    function RespostasQUIZ() {

        // Enviando o valor da nova input
        fetch("/usuarios/RespostasQUIZ", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                parte1Server: parte1Var,
                parte2Server: parte2Var,
                parte3Server: parte3Var,
                parte4Server: parte4Var,
                parte5Server: parte5Var,
                pontosServer: pontos,
                ID_USUARIOServer: ID_USUARIOVar,
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {

                alert('Respostas registradas com sucesso!')
                setTimeout(() => {
                    window.location = "cards.html";
                }, "2000")

            } else {
                throw ("Houve um erro ao tentar registrar as respostas!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        return false;
    }
    
    function media() {
        b_media.innerHTML = sessionStorage.MEDIA_USUARIOS

        fetch(`/usuarios/media`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    var json = JSON.stringify(resposta);
                    console.log(resposta[0].media);
                    sessionStorage.MEDIA_USUARIOS = resposta[0].media
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }

</script>

</html>